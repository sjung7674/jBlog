<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security"
	xmlns:beans="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:context="http://www.springframework.org/schema/context"
	xsi:schemaLocation="http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-4.2.xsd
		http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd
		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.3.xsd">

<http auto-config='true'>
    <intercept-url pattern="/write" access="hasRole('ROLE_USER')" />
    <form-login 
		    login-page="/member/login" 
		    login-processing-url="/member/login"
		    username-parameter="inputEmail"
		    password-parameter="inputPassword"
		    authentication-success-handler-ref="loginSuccessHandler"
		    authentication-failure-handler-ref="loginFaliedHandler"
		    />
		<logout 
		    logout-success-url="/member/logout" 
		    logout-url="/member/j_sprint_security_logout" 
		    delete-cookies="true" 
		    invalidate-session="true"/>
</http>		
<authentication-manager>
  <authentication-provider user-service-ref="memberServiceImpl">
  	<password-encoder ref="encoder"/>
  </authentication-provider>
</authentication-manager>	

<beans:bean id="encoder" class="org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder"/>	
<beans:bean id="memberServiceImpl" class="com.hjb.jBlog.service.impl.MemberServiceImpl"/>		
<beans:bean id="loginSuccessHandler" class="com.hjb.jBlog.common.LoginSuccessHandler"/>
<beans:bean id="loginFaliedHandler" class="com.hjb.jBlog.common.LoginFailHandler"/>
</beans:beans>